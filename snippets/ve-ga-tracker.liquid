<script>
//setTimeout(function() { initGATracker(); }, 1000);
initGATracker();

function initGATracker() {
  //try {
    //$(document).ready(function () {
    window.onload = function() {
      ga('create', 'UA-117351135-6', 'auto');

      //track all <a> clicks in GA
      var links = document.querySelectorAll('a');
      for (var i=0; i<links.length; i++) {
        links[i].addEventListener('click', function(event) {
          var eventCategory = 'ClickedAnchor';
          var eventLabel = this.href;
          ve_sendGATrackerEvent(eventCategory, eventLabel);
        });
      }

      /*
      //track collection sorting
      $('#sort-by').change(function() {
        var eventCategory = 'SortedCollection';
        var eventLabel = $(this).val();
        ve_sendGATrackerEvent(eventCategory, eventLabel);
      });
      */

      //track home page cover photo
      var links = document.querySelectorAll('.banner');
      for (var i=0; i<links.length; i++) {
        links[i].addEventListener('click', function(event) {
          var eventCategory = 'ClickedHomeHeroImage';
          var eventLabel = this.parentElement.querySelectorAll('link')[0].href.split('?')[0];
          var eventAction = this.href;
          ve_sendGATrackerEvent(eventCategory, eventLabel, eventAction);
        });
      }

      /*
      //minisite addtocart
      $('.js_add-btn').click(function() {
        var radio_selected = $('input[name="input-kit-id"]:radio:checked');
        var variantId = $(radio_selected).attr("data-variant-id");
        var eventCategory = 'ClickedAnchor';
        var eventLabel = 'addtocart_' + variantId + '_';
        ve_sendGATrackerEvent(eventCategory, eventLabel);
      });

      //general addtocart
      $('.ve-add-cart-btn').click(function() {
        var variantId = $(this).attr('data-selected-variant-id');
        var variantSku = $(this).attr('data-selected-variant-sku');
        var eventCategory = 'ClickedAnchor';
        var eventLabel = 'addtocart_' + variantId + '_' + variantSku;
        ve_sendGATrackerEvent(eventCategory, eventLabel);
      });*/

      //recommended product addtocart is coded directly into _ve_theme_2.js under addRecommendationToCart()

      //click variant image is coded directly into _ve_theme_2.js under productVariantSelection()

      //subscription popup on product page is coded directly into snippets/ve-product-form.liquid under popupSubscribeAndSave()
    //});
    }
  /*} catch(ob) {
  	console.log(ob);
  	setTimeout(function() { initGATracker(); }, 100);
  }*/
}

function ve_sendGATrackerEvent(eventCategory, eventLabel, forceEventAction) {
  var spl = window.location.href.split('?');
  if (spl[0].substr(-1) != '/') {
    spl[0] += '/';
  }
  var eventAction = spl[0];
  if (forceEventAction) {
    eventAction = forceEventAction;
  }
  var eventValue = 1;
  ga('send', 'event', { 'eventCategory': eventCategory, 'eventAction': eventAction, 'eventLabel': eventLabel, 'eventValue': eventValue });
}
</script>
