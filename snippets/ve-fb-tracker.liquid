<script>
setTimeout(function() { initFBTracker(); }, 1000);

function initFBTracker() {
  //try {
    var fbq = window.fbq || null;
    window.onload = function() {
    //$(document).ready(function () {
      //track all <a> clicks in FB
      var links = document.querySelectorAll('a');
      for (var i=0; i<links.length; i++) {
        links[i].addEventListener('click', function(event) {
          var eventCategory = 'ClickedAnchor';
          var eventLabel = this.href;
          ve_sendFBTrackerEvent(eventCategory, { url: eventLabel });
        });
      }
    }
    //});
  /*} catch(ob) {
  	console.log(ob);
  	setTimeout(function() { initFBTracker(); }, 100);
  }*/
}

function ve_sendFBTrackerEvent(eventName, eventData) {
  if (eventData === undefined) {
    eventData = {};
  } else if (typeof eventData === 'string') {
    eventData = { url: eventData }
  }
  var spl = window.location.href.split('?');
  if (spl[0].substr(-1) != '/') {
    spl[0] += '/';
  }
  eventData.origin_url = spl[0];
  //alert(eventCategory + ', ' + eventAction + ', ' + eventLabel);
  try{
    fbq('trackCustom', eventName, eventData);
  } catch(ob){
    console.log('fbq error', ob);
  }
}
</script>
